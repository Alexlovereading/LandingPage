function $$(e, n) {
    var t = (n = n || document).querySelectorAll(e);
    return Array.prototype.slice.call(t)
}
var popupBtn = document.querySelector(".spin"),
    popup = document.querySelector(".popup"),
    bonusTextElement = document.querySelector(".popup-text .bonus-wrap"),
    bonusTextElementSpan = bonusTextElement.querySelector("span");

function openPopup(e) {
    document.body.classList.contains("active") ? (document.body.classList.remove("active"), popupBtn.innerHTML = "КРУТИТЬ") : (document.body.classList.add("active"), popupBtn.innerHTML = "ЗАБРАТЬ БОНУС")
}
var ruleteStart = !1,
    spinBool = !1;
popupBtn.addEventListener("click", function(e) {
    return spinBool ? (e.preventDefault(), !1) : ruleteStart ? void 0 : (e.preventDefault(), spin(), !1)
}, !1);
var rand = Math.round(3 * Math.random());
if (1 == rand) var gre = "green.png",
    red = "pink.png",
    bro = "beige.png";
else if (2 == rand) gre = "beige.png", red = "green.png", bro = "pink.png";
else gre = "pink.png", red = "beige.png", bro = "green.png";
var combination = [];

function initRulete() {
    $$(".main-part .column .characters").forEach(function(e, n) {
        e.parentNode.offsetHeight;
        for (var t = 0; t < 30; t++) {
            var r = document.createElement("img"),
                o = document.createElement("div");
            if (27 == t) var a = combination[0][n];
            else if (28 == t) a = combination[0][n + 3];
            else if (29 == t) a = combination[0][n + 6];
            else {
                var i = Math.round(8 * Math.random());
                a = combination[0][i]
            }
            r.src = "images/" + a, o.classList.add("img_wrap"), o.appendChild(r), o.style.height = e.parentNode.offsetHeight / 3 + "px", o.style.lineHeight = e.parentNode.offsetHeight / 3 + "px", e.appendChild(o)
        }
    }), posTop()
}

function spin() {
    spinBool = !0, $$(".main-part .column .characters").forEach(function(e, n) {
        e.style.transitionDuration = 500 * n + 3e3 + "ms", e.style.transform = "translateY(-" + $$(".img_wrap", e)[27].offsetTop + "px)"
    }), setTimeout(function() {
        $$(".main-part .flash")[0].style.opacity = "1"
    }, 4e3), setTimeout(function() {
        spinBool = !1, ruleteStart = !0, $$(".main-part .column .characters").forEach(function(e, n) {
            e.style.transitionDuration = "1ms"
        }), document.body.classList.add("active"), popupBtn.innerHTML = popupBtn.dataset.aftertext
    }, 5e3)
}

function posTop() {
    $$(".main-part .column .characters").forEach(function(e, n) {
        var t = e.parentNode.offsetHeight / 3;
        $$(".img_wrap", e).forEach(function(e, n) {
            e.style.top = t * n + "px"
        })
    })
}
combination[0] = [gre, gre, gre, red, red, red, bro, bro, bro], initRulete(), window.onresize = function() {
    posTop(), ruleteStart && $$(".main-part .column .characters").forEach(function(e, n) {
        e.style.transform = "translateY(-" + $$(".img_wrap", e)[27].offsetTop + "px)"
    })
};